# 카프카 보안

카프카는 기업 내부의 시스템으로 주로 활용하기 때문에 보안에 대해서는 큰 신경을 쓰지 않는다.

카프카는 보안이 필요하면 직접 관리자가 적용해야 한다. 보안을 적용하기 쉽지 않다.

## 카프카 보안의 세가지 요소

* 암호화 : 클라이언트와 암호화가 안되어 있다. 
* 인증 : 카프카 클라이언트들이 카프카로 접근할때 안전하다고 확인된 클라이언트만 접근할수 있도록 설정
* 권한 : 인증받은 클라이언트들이 모든권한을 가지면 문제가 생길수도 있다. 토픽별 권한 설정을 할수 있게 한다.

### 암호화
암호화는 SSL로 적용 할 수 있다.

### 인증

SASL 
 * SASL/GSSAPI : 카프카 0.9 버전 부터 지원됨. GSSAPI는 커버로스 인증 방식으로 많이 사용되는 인증 방식중 하나
 * SASL/PLAIN : 0.10.0 버전부터 지원. PLAIN은 아이디와 비밀번호를 텍스트 형태로 사용하는 방법
 * SASL/SCRAM-SHA-256, SASL/SCRAM-SHA-512 : 0.10.2 버전부터 지원. 솔티드 챌린지 응답 인증 메커니즘
 * SASL/OAUTHBEARER : 2.0 버전 부터 지원됨 OAUTH 핸들러를 따로 구성해야 되서 운영환경에서 사용하기에 불편하다.

### 권한(ACL)

접근제어 리스트를 만들어 접근제어를 한다.

## SSL을 이용한 카프카 암호화

자바기반 어플리케이션에서는 키스토어 라는 인터페이스를 통해서 퍼블릭 키, 프라이빗 키, 인증서를 추상해 제공한다.

클라이언트 -> 서버
트러스트스토어 -> 키스토어

인증서의 프라이빗 키는 절대로 유출 되면 안된다.

클라이언트와 카프카 클러스터가 신뢰할수 있는 네트워크 환경내에 있으면 구성을 안해도 된다.

## 커버로스(SASL)를 이용한 카프카 인증

커버로스를 많이 사용하는 이유 오래 되고 SSO를 지원하기 때문이다.


## ACL을 이용한 카프카 권한 설정

kafka-acls.sh 로 사용자별로 권한설정을 할수 있다.




# 참고

------

* [Authentication with SASL using JAAS](https://docs.confluent.io/platform/current/kafka/authentication_sasl/index.html)
* [Authorization using ACLs](https://docs.confluent.io/platform/current/kafka/authorization.html)